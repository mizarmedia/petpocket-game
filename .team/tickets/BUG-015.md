# BUG-015: No localStorage error handling in gameStore

**Severity:** High
**Status:** Claimed
**Found by:** audit
**Assigned to:** generalist-3
**Created:** 2025-12-25 15:41

## Description
The Zustand persist middleware uses localStorage but has no error handling for common failure scenarios.

Issues:
1. No handling for localStorage being disabled/unavailable
2. No handling for quota exceeded errors
3. No handling for corrupted stored data
4. Users lose all progress silently if storage fails

Expected: Graceful error handling with user feedback
Actual: Silent failures, potential data loss

Suggested fix (from AUDIT_REPORT.md):
Add error handling via persist middleware options:
```tsx
persist(
  (set, get) => ({ /* store */ }),
  {
    name: 'petplay-storage',
    onRehydrateStorage: () => (state, error) => {
      if (error) {
        console.error('Failed to load saved data:', error)
        // Show user-friendly message
      }
    }
  }
)
```

File: src/stores/gameStore.ts
Severity: High - Data loss risk
Reference: AUDIT_REPORT.md HIGH-002

## Steps to Reproduce
See description

## Expected Behavior
Feature should work correctly without this bug.

## Actual Behavior
The Zustand persist middleware uses localStorage but has no error handling for common failure scenarios.

Issues:
1. No handling for localStorage being disabled/unavailable
2. No handling for quota exceeded errors
3. No handling for corrupted stored data
4. Users lose all progress silently if storage fails

Expected: Graceful error handling with user feedback
Actual: Silent failures, potential data loss

Suggested fix (from AUDIT_REPORT.md):
Add error handling via persist middleware options:
```tsx
persist(
  (set, get) => ({ /* store */ }),
  {
    name: 'petplay-storage',
    onRehydrateStorage: () => (state, error) => {
      if (error) {
        console.error('Failed to load saved data:', error)
        // Show user-friendly message
      }
    }
  }
)
```

File: src/stores/gameStore.ts
Severity: High - Data loss risk
Reference: AUDIT_REPORT.md HIGH-002

## Environment
- **URL:** Production
- **Device:** See description

---

## Fix Notes
*Fixer fills this in when working*

**Root Cause:**
**Fix Applied:**
**Files Modified:**

---

## Verification
*Reviewer fills this in*

**Verified:**
**Tested On:**
**Notes:**
